<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Amistad Infinita HD</title>
    <style>
        body { margin: 0; background: #000; overflow: hidden; font-family: 'Arial Black', sans-serif; touch-action: none; }
        canvas { display: block; }
        
        #btn-inicio {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            padding: 20px 40px; font-size: 1.2rem; background: transparent; color: #fff;
            border: 2px solid #fff; border-radius: 5px; cursor: pointer; z-index: 100;
            letter-spacing: 3px; transition: 0.5s;
        }
        #btn-inicio:hover { background: #fff; color: #000; box-shadow: 0 0 50px #fff; }

        #instrucciones {
            position: fixed; bottom: 8%; width: 100%; text-align: center;
            color: rgba(255,255,255,0.4); font-size: 0.8rem; letter-spacing: 2px;
            pointer-events: none; text-transform: uppercase; display: none;
        }
    </style>
</head>
<body>

    <button id="btn-inicio" onclick="comenzar()">ABRIR REGALO üéÅ</button>
    <div id="instrucciones">Toca para descubrir otra raz√≥n</div>

    <audio id="musica" loop>
        <source src="musica.mp3" type="audio/mpeg">
    </audio>

    <canvas id="canvas"></canvas>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const audio = document.getElementById('musica');
        
        const frases = [
            "Eres la mejor amiga del mundo", "Gracias por tantas risas", "Nuestra amistad es un tesoro",
            "Eres s√∫per leal", "Gracias por escucharme siempre", "Haces todo m√°s divertido",
            "Qu√© suerte haberte conocido", "Eres una crack", "Nuestras locuras son lo mejor",
            "Eres mi mejor confidente", "Admiro tu forma de ser", "Por m√°s a√±os de amistad",
            "Siempre me haces el d√≠a", "Me encanta nuestra vibra", "Eres pura buena onda",
            "Gracias por los consejos", "Eres de mi equipo siempre", "Nadie me entiende como t√∫",
            "Eres una persona valiosa", "Amo nuestras an√©cdotas", "Eres mi apoyo constante",
            "Qu√© buen equipo hacemos", "Eres aut√©ntica", "Gracias por estar siempre",
            "Nuestra amistad no tiene precio", "Eres s√∫per talentosa", "Me encanta tu energ√≠a",
            "Eres la persona m√°s divertida", "Gracias por ser t√∫", "Eres mi hermana elegida",
            "Siempre tienes la palabra justa", "Por mil aventuras m√°s", "Eres de las que suma",
            "Nuestra amistad es de hierro", "Qu√© buenos recuerdos", "Eres clave en mi vida",
            "Gracias por tu sinceridad", "Eres mi persona favorita", "Haces todo m√°s f√°cil",
            "Eres una gran amiga", "Aprecio nuestra lealtad", "Eres pura luz",
            "Gracias por no juzgarme", "Eres la mejor para los planes", "Nuestra conexi√≥n es √∫nica",
            "Eres un ejemplo", "Amo tu sentido del humor", "Amistades como la tuya son eternas",
            "Gracias por ser tan real", "Eres mi apoyo total", "Nuestras pl√°ticas son lo mejor",
            "Eres s√∫per inteligente", "Qu√© bien la pasamos", "Eres mi mejor aliada",
            "Gracias por aguantar mis locuras", "Eres brillante", "Amo tu honestidad",
            "Eres de lo mejor que tengo", "Nuestra amistad es indestructible", "Eres creativa",
            "Gracias por motivarme", "Eres de palabra", "Qu√© risas nos damos",
            "Siempre puedo contar contigo", "Vales oro", "Gracias por tu tiempo",
            "Eres la m√°s ocurrente", "Amistad incondicional", "Eres de mente abierta",
            "Me encanta c√≥mo escuchas", "Eres incre√≠ble", "Gracias por ser mi gu√≠a",
            "Eres mi mejor socia", "Nuestras historias son leyenda", "Eres de buen coraz√≥n",
            "Qu√© fortuna tenerte cerca", "Eres mi gran apoyo", "Gracias por ser noble",
            "Eres valiente", "Amo nuestra confianza", "Eres de mis mejores recuerdos",
            "Amistad a prueba de todo", "Eres s√∫per capaz", "Gracias por la paciencia",
            "La mejor para charlar", "Qu√© buena vibra", "Eres alguien especial",
            "Siempre est√°s ah√≠", "Eres mi mejor partner", "Gracias por ser mi amiga",
            "Amigas por siempre", "Eres fuera de serie", "¬°Eres la mejor!"
        ];

        let particles = [];
        let indexFrase = 0;
        let stage = 0; // 0: Lluvia, 1: Frase
        const dpr = window.devicePixelRatio || 2;

        function comenzar() {
            document.getElementById('btn-inicio').style.display = 'none';
            document.getElementById('instrucciones').style.display = 'block';
            audio.play().catch(() => {});
            stage = 0;
            init();
            animate();
        }

        function setSize() {
            canvas.width = window.innerWidth * dpr;
            canvas.height = window.innerHeight * dpr;
            ctx.scale(dpr, dpr);
            canvas.style.width = window.innerWidth + 'px';
            canvas.style.height = window.innerHeight + 'px';
        }

        class Particle {
            constructor(tx, ty) {
                this.tx = tx; this.ty = ty;
                this.x = Math.random() * window.innerWidth;
                this.y = Math.random() * -window.innerHeight;
                this.vx = (Math.random() - 0.5) * 2;
                this.vy = Math.random() * 3 + 2;
                this.active = true;
                this.size = Math.random() * 1.5 + 0.8;
                this.color = "#ffffff";
            }

            update() {
                if (stage === 0) {
                    this.y += this.vy;
                    if (this.y > window.innerHeight) this.y = -20;
                } else if (this.active) {
                    this.x += (this.tx - this.x) * 0.1;
                    this.y += (this.ty - this.y) * 0.1;
                } else {
                    this.x += this.vx; this.y += this.vy;
                    this.vx *= 0.96; this.vy *= 0.96;
                }
            }

            draw() {
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        function obtenerPuntos(texto) {
            const tCanvas = document.createElement('canvas');
            const tCtx = tCanvas.getContext('2d');
            tCanvas.width = window.innerWidth;
            tCanvas.height = window.innerHeight;
            const isMob = window.innerWidth < 600;
            const fSize = isMob ? 32 : 55;
            tCtx.font = `900 ${fSize}px sans-serif`;
            tCtx.textAlign = 'center';
            tCtx.textBaseline = 'middle';
            
            const palabras = texto.split(" ");
            let lineas = [], lineaActual = "";
            palabras.forEach(p => {
                if((lineaActual + p).length > (isMob ? 16 : 30)) {
                    lineas.push(lineaActual); lineaActual = p + " ";
                } else { lineaActual += p + " "; }
            });
            lineas.push(lineaActual);

            lineas.forEach((l, i) => {
                tCtx.fillText(l, tCanvas.width/2, tCanvas.height/2 + (i * fSize * 1.2) - (lineas.length * fSize / 2));
            });

            const data = tCtx.getImageData(0, 0, tCanvas.width, tCanvas.height).data;
            let pts = [];
            for (let y = 0; y < tCanvas.height; y += 3) {
                for (let x = 0; x < tCanvas.width; x += 3) {
                    if (data[(y * tCanvas.width + x) * 4 + 3] > 128) pts.push({x, y});
                }
            }
            return pts;
        }

        function init() {
            setSize();
            const pts = obtenerPuntos(frases[0]);
            particles = pts.map(p => new Particle(p.x, p.y));
        }

        function cambiarFrase() {
            if (stage === 0) {
                stage = 1;
                return;
            }
            
            particles.forEach(p => {
                p.active = false;
                p.vx = (Math.random() - 0.5) * 40;
                p.vy = (Math.random() - 0.5) * 40;
            });

            indexFrase++;
            const pts = obtenerPuntos(frases[indexFrase % frases.length]);
            
            setTimeout(() => {
                particles = pts.map(p => new Particle(p.x, p.y));
            }, 150);
        }

        function animate() {
            ctx.fillStyle = 'rgba(0, 0, 0, 0.25)';
            ctx.fillRect(0, 0, window.innerWidth, window.innerHeight);
            particles.forEach(p => { p.update(); p.draw(); });
            requestAnimationFrame(animate);
        }

        window.addEventListener('mousedown', (e) => { if(e.target.id !== 'btn-inicio') cambiarFrase(); });
        window.addEventListener('touchstart', (e) => { if(e.target.id !== 'btn-inicio') cambiarFrase(); });
        window.addEventListener('resize', setSize);
    </script>
</body>
</html>
